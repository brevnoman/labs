{% extends "base.html" %}

{% block title %}
Cart
{% endblock %}

{% block content %}
<h1>Yor Cart</h1>
{% if cart.total_products > 0 %}
<table class="table">
  <thead>
    <tr>
      <th scope="col">Product</th>
      <th scope="col">Image</th>
      <th scope="col">Cost</th>
      <th scope="col">qnt</th>
        <th scope="col">Final Price</th>
      <th scope="col"></th>
    </tr>
  </thead>
{% for i in cart.products.all %}
  <tbody>
    <tr>
      <th scope="row"><a class="link-dark" href="{% url 'product_detail_page' id=i.product.id %}">{{ i.product.title }}</a></th>
      <td class="w-25">
        <a href="{% url 'product_detail_page' id=i.product.id %}">
        {% if i.product.image %}
            <img class="img-fluid" src="{{ i.product.image.url }}" width="100%">
        {% else %}
            <img class="img-fluid" src="https://zenit.by/images/no_photo.png" width="100%">
        {% endif %}</a></td>
        </td>
        <td class="w-25">{{ i.product.price }}</td>
      <td class="w-25">
        <form action="{% url 'add_to_cart_page' %}" method="POST">
            {% csrf_token %}
            <input name="id" value="{{ i.product.id }}" type="hidden">
            <input type="submit" value="^" class="btn btn-dark">
        </form>
        <form action="{% url 'change_qty' %}" method=POST>
          {% csrf_token %}
          <input name="id" value="{{ i.product.id }}" type="hidden">
            <input name="cart" value="{{ cart }}" type="hidden">
        <input required="required" type="number" min="1" name="qty" value="{{ i.qty }}">
        </form>
        <form action="{% url 'remove_cart_product' %}" method="POST">
            {% csrf_token %}
            <input name="id" value="{{ i.product.id }}" type="hidden">
            <input name="cart" value="{{ cart }}" type="hidden">
            <input type="submit" value="v" class="btn btn-dark">
        </form>
      </td>
      <td class="w-25">{{ i.final_price }}</td>
    </tr>
{% endfor %}

  <tbody>
    <tr>
      <th scope="row"></th>
      <td class="w-25"></td>
      <td class="w-25"></td>
        <td class="w-25">Total Price:</td>
      <td class="w-25">{{ cart.final_price }}</td>
      <td class="w-25"><a href="{% url 'checkout' %}" class="btn btn-outline-dark">Make order</a></td>
    </tr>
</tbody>
  {% else %}
  <h1>is empty</h1>
  {% endif %}
</table>
{% endblock %}
<!--<img class="img-fluid" src="-->
<!--                            {% if product.image %}-->
<!--                                {{ product.image.url }}-->
<!--                            {% else %}-->
<!--                                https://zenit.by/images/no_photo.png-->
<!--                            {% endif %}-->
<!--                            ">-->